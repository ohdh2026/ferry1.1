<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì„ ë°• ìš´í•­ ì¼ì§€</title>
<style>
body { font-family:'ë§‘ì€ ê³ ë”•'; background:#f5faff; padding:20px; max-width:1200px; margin:auto; }
h1 { color:#0066cc; }
table { width:100%; border-collapse:collapse; background:#e6f2ff; margin-bottom:20px; }
th,td { border:1px solid #0066cc; padding:8px; text-align:center; }
th { background:#0066cc; color:#fff; }
input, select, textarea { width:100%; padding:6px; box-sizing:border-box; }
textarea { min-height:70px; }
button { background:#0066cc; color:#fff; padding:10px 20px; border:none; cursor:pointer; margin-right:10px;}
</style>
</head>
<body>

<h1>ğŸš¢ ì„ ë°• ìš´í•­ ì¼ì§€</h1>

<table>
<tr>
  <th>ì„ ë°•ëª…</th>
  <td><select id="ship"><option value="">ì„ íƒ</option><option>ì¸ì–´ê³µì£¼í˜¸</option><option>íƒë‚˜ë¼í˜¸</option><option>ì•Œë¼ë”˜í˜¸</option><option>ì•„ì¼ë ˆë‚˜í˜¸</option><option>ê°€ìš°ë””í˜¸</option><option>ë‚¨ì´51í˜¸</option></select></td>
  <th>ì¶œë°œì§€</th>
<td><select id="startSelect"><option value="">ì„ íƒ</option>
<option>ê°€í‰ë‚˜ë£¨</option><option>ë‚¨ì´ë‚˜ë£¨</option><option>ë©”íƒ€ë‚˜ë£¨</option></select></td>`


</tr>
<tr>
  <th>ë‚ ì§œ</th><td><input type="date" id="date"></td>
  <th>ì¶œë°œì‹œê°„</th><td><input type="time" id="departTime"></td>
</tr>
<tr>
  <th>ë„ì°©ì‹œê°„</th><td><input type="time" id="arriveTime"></td>
  <th>ìŠ¹ê°ì¸ì›</th><td><input type="number" id="cargoCount" min="0"></td>
</tr>
<tr>
  <th>ì„ ì¥</th><td>
<select id="captainMain"><option value="">ì„ íƒ</option>
<option>ì˜¤ì„±íƒ</option><option>ê¹€ê´‘ì—½</option><option>ì‹ êµì² </option><optios>ì‹ ì§€ì›</option><option>ì§„ì°½ì–µ</option><option>ì¡°ì‹ í¬</option><option>ê¸°íƒ€</option></select></td>


  <th>ê¸°ê´€ì¥</th><td>
<select id="captainSub"><option value="">ì„ íƒ</option>
<option>ê¹€ì˜ì°½</option><option>ì •ìœ¤ëª¨</option><option>ì˜¤ìŠ¹ì² </option><optios>ê°•ì¶˜ì‹</option><option>ì´ì¤€ê¸¸</option><option>ì†¡ì¬ìš´</option><option>ê¸°íƒ€</option></select></td>


</tr>
<tr>
  <th>ì£¼ìœ ëŸ‰</th>
<td><input type="number" id="oilMount" min="0"></td>

  <th>ì†Œì†</th><td><input id="department" value="ìš´í•­íŒ€"></td>
</tr>
</table>

<h3>ğŸ‘¨â€âœˆï¸ ìŠ¹ë¬´ì› ëª…ë‹¨</h3>
<select id="crewSelect"><option value="">ì„ íƒ</option>
<option>ê¹€ì •ë•</option><option>ê¹€ê±´í•œ</option><option>ì¡°ì‹ í¬</option><optios>ì˜¤ì„±íƒ</option><option>ìµœìŠ¹í›ˆ</option><option>ì´ì‹œì˜</option><option>ì—†ìŒ</option></select>
<h3>íŠ¹ì´ì‚¬í•­</h3>
<textarea id="notes"></textarea>

<br><br>
<button id="saveBtn">ì €ì¥í•˜ê¸°</button>
<button id="downloadBtn">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>

<hr>
<h2>ğŸ“‹ ì €ì¥ëœ ìš´í•­ ê¸°ë¡</h2>
<table>
<thead>
<tr>
  <th>ì„ ë°•ëª…</th><th>ì¶œë°œì§€</th><th>ë‚ ì§œ</th>
  <th>ì¶œë°œì‹œê°„</th><th>ë„ì°©ì‹œê°„</th><th>ì„ ì¥</th><th>ê¸°ê´€ì¥</th><th>ìŠ¹ê°ì¸ì›</th>
  <th>ì£¼ìœ ëŸ‰</th><th>ìŠ¹ë¬´ì›</th><th>íŠ¹ì´ì‚¬í•­</th>
</tr>
</thead>
<tbody id="logTableBody"></tbody>
</table>

<script>
let db;
const request = indexedDB.open("Ferry1",1);
request.onupgradeneeded = e => {
  db = e.target.result;
  if(!db.objectStoreNames.contains("logs")){
    db.createObjectStore("logs",{keyPath:"id",autoIncrement:true});
  }
};
request.onsuccess = e => {
  db = e.target.result;
  loadLogs();
};

document.getElementById("saveBtn").addEventListener("click", saveLog);

function saveLog(){
  if(!db) return;

  const data = {
    ship: document.getElementById("ship").value,
    startSelect: document.getElementById("startSelect").value,
    date: document.getElementById("date").value,
    depart: document.getElementById("departTime").value,
    arrive: document.getElementById("arriveTime").value,
    captainMain: document.getElementById("captainMain").value,
    captainSub: document.getElementById("captainSub").value,
    cargo: document.getElementById("cargoCount").value,
    oil: document.getElementById("oilMount").value,
    crew: document.getElementById("crewSelect").value,
    notes: document.getElementById("notes").value
  };

  if(!data.depart||!data.arrive||!data.cargo){
    alert("í•„ìˆ˜ í•­ëª© ëˆ„ë½"); return;
  }

  const tx = db.transaction("logs","readwrite");
  tx.objectStore("logs").add(data);
  tx.oncomplete = ()=>{
    appendRow(data);
    clearForm();
  };
}

function appendRow(d){
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td>${d.ship}</td><td>${d.startSelect}</td><td>${d.date}</td>
    <td>${d.depart}</td><td>${d.arrive}</td><td>${d.captainMain}</td><td>${d.captainSub}</td>
    <td>${d.cargo}</td><td>${d.oil}</td><td>${d.crew}</td><td>${d.notes}</td>
  `;
  document.getElementById("logTableBody").appendChild(tr);
}

function clearForm(){
  document.querySelectorAll("input, textarea").forEach(e=>e.value="");
  document.getElementById("crewSelect").value="";
}

function loadLogs(){
  const tbody = document.getElementById("logTableBody");
  tbody.innerHTML="";
  const tx = db.transaction("logs","readonly");
  tx.objectStore("logs").getAll().onsuccess=e=>{
    e.target.result.forEach(l=> appendRow(l));
  };
}

document.getElementById("downloadBtn").addEventListener("click", function(){
  let xls = "ì„ ë°•ëª…,í†¤ìˆ˜,ë‚ ì§œ,ì¶œë°œì‹œê°„,ë„ì°©ì‹œê°„,ì„ ì¥,ê¸°ê´€ì¥,ìŠ¹ê°ì¸ì›,ì£¼ìœ ëŸ‰,ìŠ¹ë¬´ì›ì´ì‚¬í•­\n";
  const rows = document.querySelectorAll("#logTableBody tr");
  rows.forEach(r=>{
    const cols = r.querySelectorAll("td");
    let line = [];
    cols.forEach(c=>{
      line.push('"' + c.textContent.replace(/"/g,'""') + '"');
    });
     xls += line.join(",") + "\n";
  });
  const books = "\uFEFF";
  const blob = new Blob([books + xls],{type:"text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "ìš´í•­ê¸°ë¡";
  a.click();
  URL.revokeObjectURL(url);
});
</script>

</body>
</html>





































